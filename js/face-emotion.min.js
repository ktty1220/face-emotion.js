(function(){"use strict";var t,s,e,i,o,r,h,n,a,u,p,d,l,c,f,b=function(t,s){return function(){return t.apply(s,arguments)}},m={}.hasOwnProperty,y=function(t,s){for(var e in s){if(m.call(s,e))t[e]=s[e]}function i(){this.constructor=t}i.prototype=s.prototype;t.prototype=new i;t.__super__=s.prototype;return t};n="face-emotion-";a=false;u={venderPrefix:function(t){var s,e,i,o,r,h;e=[t];s=""+t.substr(0,1).toUpperCase()+t.substr(1);h=["ms","Webkit","Moz","O"];for(o=0,r=h.length;o<r;o++){i=h[o];e.push(""+i+s)}return e},borderRadius:function(t){return{borderTopLeftRadius:t,borderTopRightRadius:t,borderBottomRightRadius:t,borderBottomLeftRadius:t}},borderWidth:function(t,s,e,i){var o;return{borderTopWidth:t,borderRightWidth:s!=null?s:t,borderBottomWidth:e!=null?e:t,borderLeftWidth:(o=i!=null?i:s)!=null?o:t}},sum:function(t,s){var e,i;e=Math.round(t*100+s*100);i=e<0?"-":"";return parseFloat((""+i+"00"+Math.abs(e)).replace(/(..)$/,".$1"))},styleNumValue:function(t){var s,e;return parseFloat((s=((e=(""+t).match(/(-?[\d\.]+)/))!=null?e:[])[1])!=null?s:"0")},caseConv:function(t){return t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})},expandSelector:function(t,s){var e,i,o,r,h;if(s==null){s=""}o=s.replace(/:a/g,":after").replace(/:b/g,":before").split(",");e=[];for(r=0,h=o.length;r<h;r++){i=o[r];if(i.length>0&&i.substr(0,1)!==":"){i="-"+i}e.push("."+n+t+i)}return e.join(",\n")},addEffectStyle:function(t){var s,e,i,o,r,h,n,p,d,l;if(a){return}r="";for(l in t){i=t[l];for(n in i){p=i[n];r+=""+u.expandSelector(l,n)+" {\n";for(s in p){o=p[s];if(typeof o==="number"){o+="px"}r+="  "+u.caseConv(s)+": "+o+";\n"}r+="}\n"}}e=document.getElementsByTagName("head")[0];d=document.createElement("style");h=document.createTextNode(r);d.type="text/css";if(d.styleSheet){d.styleSheet.cssText=h.nodeValue}else{d.appendChild(h)}e.appendChild(d);return a=true}};o=function(){t.prototype.commonCss={position:"absolute",background:"transparent",borderStyle:"solid",borderColor:"#000",height:0,zIndex:"10"};function t(t,s){this.opt=t;this.pos=s;this.setStyle=b(this.setStyle,this);this.applyCss=b(this.applyCss,this);this.set=b(this.set,this);this.abort=b(this.abort,this);this.progress=b(this.progress,this);this.init();this.el=document.createElement("div");if(this.pos==="effect"){this.el.className=""+n+"effect "+n+this.name}else{this.el.className=""+n+"parts "+n+this.name;this.setStyle(this.commonCss);this.setStyle(this.css)}this.deg=this.pos==="left"?-1:this.pos==="right"?1:0;this.cur=100;this.timer=null}t.prototype.progress=function(t){var s,e;if(t==null){t=true}s=(e=this.calc())!=null?e:{};this.applyCss(s);if(t){this.setStyle(s)}return this.cur+=this.step};t.prototype.abort=function(){if(this.timer!=null){clearInterval(this.timer);return this.timer=null}};t.prototype.set=function(t,s,e){var i,o,r,h,n=this;if(t==null){t=0}if(s==null){s={}}if(this.effect!=null){this.effect.set(t,s)}this.goto=t;this.goto=this.goto>100?100:this.goto<-100?-100:this.goto;this.goto+=100;this.step=this.goto>this.cur?1:this.goto<this.cur?-1:0;this.adjust=this.step===-1?1:0;i=0;r=Math.abs(this.goto-this.cur);if(s.animate){return this.timer=setInterval(function(){n.progress(true);if(++i>=r){n.abort();return typeof e==="function"?e():void 0}},s.speed)}else{for(o=h=0;0<=r?h<r:h>r;o=0<=r?++h:--h){this.progress(false)}this.setStyle(this.css);return typeof e==="function"?e():void 0}};t.prototype.applyCss=function(t){var s,e,i;if(t==null){t={}}i=[];for(s in t){e=t[s];i.push(this.css[s]=e)}return i};t.prototype.setStyle=function(t){var s,e,i;if(t==null){t={}}i=[];for(s in t){e=t[s];if(typeof e==="number"){e+="px"}i.push(this.el.style[s]=e)}return i};return t}();e=function(t){y(s,t);function s(){this.calc=b(this.calc,this);p=s.__super__.constructor.apply(this,arguments);return p}s.prototype.init=function(){var t,s,e,i,o;if(!/^(right|left)$/.test(this.pos)){throw new Error("invalid Eye position: "+this.pos)}this.name="eyebrow-"+this.pos;this.css={top:this.opt.size/200*45,width:this.opt.size/10*2,height:0,borderTopWidth:this.opt.size/200*5,borderBottomWidth:this.opt.size/200*5};this.css[this.pos]=this.opt.size/10*2;i=u.venderPrefix("transform");o=[];for(s=0,e=i.length;s<e;s++){t=i[s];o.push(this.css[t]="rotate(0deg)")}return o};s.prototype.calc=function(){var t,s,e,i,o,r;e=u.sum(u.styleNumValue(this.css.transform),-.3*this.step*this.deg);s={};r=u.venderPrefix("transform");for(i=0,o=r.length;i<o;i++){t=r[i];s[t]="rotate("+e+"deg)"}return s};return s}(o);s=function(t){y(s,t);function s(){this.calc=b(this.calc,this);d=s.__super__.constructor.apply(this,arguments);return d}s.prototype.init=function(){var t,s,e,i,o,r,h,n,a;if(!/^(right|left)$/.test(this.pos)){throw new Error("invalid Eye position: "+this.pos)}this.name="eye-"+this.pos;this.css={top:this.opt.size/20*7,width:this.opt.size/20*3,height:1,backgroundColor:"#000",borderTopColor:"#000",borderBottomColor:"#000"};this.css[this.pos]=this.opt.size/20*5;r=u.venderPrefix("transform");for(i=0,o=r.length;i<o;i++){e=r[i];this.css[e]="rotate(0deg)"}h=u.borderRadius("50%");for(t in h){s=h[t];this.css[t]=s}n=u.borderWidth(this.opt.size/200*15,0);a=[];for(t in n){s=n[t];a.push(this.css[t]=s)}return a};s.prototype.calc=function(){var t,s,e,i,o,r,h;e={};switch(true){case this.cur<50+this.adjust:e.top=u.sum(this.css.top,.1*this.step);e.height=u.sum(this.css.height,-.3*this.step);e[this.pos]=u.sum(this.css[this.pos],-.05*this.step);i=u.sum(u.styleNumValue(this.css.transform),-.4*this.step*this.deg);h=u.venderPrefix("transform");for(o=0,r=h.length;o<r;o++){s=h[o];e[s]="rotate("+i+"deg)"}break;case this.cur<100+this.adjust:if(this.cur===50+this.adjust){if(this.step===1){e.borderTopColor=e.backgroundColor="#000";e.borderTopLeftRadius=e.borderTopRightRadius="30%";t=30.4}else{e.borderTopColor=e.backgroundColor="transparent";e.borderTopLeftRadius=e.borderTopRightRadius="0%";t=0}}else{t=u.sum(u.styleNumValue(this.css.borderTopLeftRadius),.4*this.step)}e.borderTopLeftRadius=e.borderTopRightRadius=""+t+"%";e.borderTopWidth=u.sum(this.css.borderTopWidth,.3*this.step);e.borderBottomWidth=u.sum(this.css.borderBottomWidth,.05*this.step);break;case this.cur<150+this.adjust:e.borderTopWidth=u.sum(this.css.borderTopWidth,-.05*this.step);e.borderBottomWidth=u.sum(this.css.borderBottomWidth,-.3*this.step);t=u.sum(u.styleNumValue(this.css.borderBottomLeftRadius),-.25*this.step);e.borderBottomLeftRadius=e.borderBottomRightRadius=""+t+"%";break;default:if(this.cur===150+this.adjust){if(this.step===1){e.borderBottomColor=e.backgroundColor="transparent";e.borderBottomLeftRadius=e.borderBottomRightRadius=e.height=0}else{e.borderBottomColor=e.backgroundColor="#000";e.borderBottomLeftRadius=e.borderBottomRightRadius="37.5%"}}e.height=u.sum(this.css.height,.5*this.step)}return e};return s}(o);r=function(t){y(s,t);function s(){this.calc=b(this.calc,this);l=s.__super__.constructor.apply(this,arguments);return l}s.prototype.name="mouth";s.prototype.init=function(){var t,s,e,i,o;this.css={top:this.opt.size/10*7,left:this.opt.size/10*3,width:this.opt.size/10*4,height:0};e=u.borderRadius("0%");for(t in e){s=e[t];this.css[t]=s}i=u.borderWidth(this.opt.size/20,0,0);o=[];for(t in i){s=i[t];o.push(this.css[t]=s)}return o};s.prototype.calc=function(){var t,s;switch(true){case this.cur<50+this.adjust:s={top:u.sum(this.css.top,.3*this.step),borderTopWidth:u.sum(this.css.borderTopWidth,-.8*this.step)};break;case this.cur<100+this.adjust:s={top:u.sum(this.css.top,.1*this.step),left:u.sum(this.css.left,.2*this.step),width:u.sum(this.css.width,-.4*this.step),height:u.sum(this.css.height,-1.5*this.step)};t=u.sum(u.styleNumValue(this.css.borderTopLeftRadius),-1*this.step);s.borderTopLeftRadius=s.borderTopRightRadius=""+t+"%";break;case this.cur<150+this.adjust:s={top:u.sum(this.css.top,-2*this.step),left:u.sum(this.css.left,-.4*this.step),width:u.sum(this.css.width,.8*this.step),height:u.sum(this.css.height,2.4*this.step)};t=u.sum(u.styleNumValue(this.css.borderBottomLeftRadius),1*this.step);s.borderBottomLeftRadius=s.borderBottomRightRadius=""+t+"%";if(this.cur===100+this.adjust){if(this.goto>100+this.adjust){s.borderTopWidth=0;s.borderBottomWidth=this.opt.size/20}else{s.borderTopWidth=this.opt.size/20;s.borderBottomWidth=0}}break;default:s={top:u.sum(this.css.top,-.5*this.step),borderBottomWidth:u.sum(this.css.borderBottomWidth,1*this.step)}}return s};return s}(o);h=function(t){y(s,t);function s(){this.calc=b(this.calc,this);c=s.__super__.constructor.apply(this,arguments);return c}s.prototype.name="tear";s.prototype.init=function(){this.css={top:u.sum(this.opt.size/200*86,0),opacity:"0"};return this.drop=u.sum(this.opt.size/200*-.36,0)};s.prototype.calc=function(){if(this.cur>49+this.adjust){return{opacity:"0"}}return{top:u.sum(this.css.top,this.drop*this.step),opacity:"1"}};return s}(o);t=function(t){y(s,t);function s(){this.calc=b(this.calc,this);f=s.__super__.constructor.apply(this,arguments);return f}s.prototype.name="angry";s.prototype.init=function(){return this.css={opacity:"0"}};s.prototype.calc=function(){if(this.cur<150+this.adjust){return{}}return{opacity:""+u.sum(u.styleNumValue(this.css.opacity),.02*this.step)}};return s}(o);i=function(){function i(i,o){var a,p,d,l,c,f,m,y,g,R,v,z,w,B,j;if(o==null){o={}}this.set=b(this.set,this);this.state=b(this.state,this);this.el=document.getElementById(i);if(!this.el){throw new Error("no such element id: "+i)}if(o.size==null){o.size=200}l={tear:{size:o.size/200*12,min:o.size/200},angry:{size:o.size/20,border:o.size/200*3,radius:3}};c={tear:{"":{position:"absolute",opacity:"0",MsFilter:'"alpha(opacity=0)"',zIndex:"5",height:l.tear.size,left:l.tear.min*60},":b,:a":{content:"''",position:"absolute"},":b":{top:l.tear.min*-4,left:l.tear.min*1.8,borderStyle:"solid",borderColor:"transparent",borderBottomColor:"#7ef",borderWidth:"0px "+l.tear.min*4+"px "+l.tear.min*8+"px"},":a":{height:l.tear.size,width:l.tear.size,top:2,left:0,background:"#7ef",borderRadius:"50%"}},angry:{"":{height:l.angry.size,position:"absolute",opacity:"0",MsFilter:'"alpha(opacity=0)"',zIndex:"5",top:l.angry.size*6,right:l.angry.size*4},"top,bottom":{position:"relative"},"top:b,top:a,bottom:b,bottom:a":{content:"''",position:"absolute",width:l.angry.size/10*4,height:l.angry.size/10*4,borderStyle:"solid",borderColor:"#f44",borderWidth:0},"top:b,top:a":{top:0,borderBottomWidth:l.angry.border},"bottom:b,bottom:a":{top:l.angry.size,borderTopWidth:l.angry.border},"top:b,bottom:b":{left:0,borderRightWidth:l.angry.border},"top:a,bottom:a":{left:l.angry.size,borderLeftWidth:l.angry.border},"top:b":{borderBottomRightRadius:l.angry.radius},"top:a":{borderBottomLeftRadius:l.angry.radius},"bottom:b":{borderTopRightRadius:l.angry.radius},"bottom:a":{borderTopLeftRadius:l.angry.radius}}};u.addEffectStyle(c);this.outline=document.createElement("div");this.outline.className=""+n+"outline";g={background:"#fff",border:"solid 4px #000",width:o.size,height:o.size,borderRadius:"50%",position:"relative"};for(p in g){y=g[p];if(typeof y==="number"){y+="px"}this.outline.style[p]=y}this.parts={eyeBrowLeft:{key:"eyebrow",obj:new e(o,"left")},eyeBrowRight:{key:"eyebrow",obj:new e(o,"right")},eyeLeft:{key:"eye",obj:new s(o,"left")},eyeRight:{key:"eye",obj:new s(o,"right")},mouth:{key:"mouth",obj:new r(o)}};z=this.parts;for(f in z){m=z[f];this.outline.appendChild(m.obj.el)}if((w=o.effect)!=null?w.tear:void 0){this.parts.tear={obj:new h(o,"effect")};this.outline.appendChild(this.parts.tear.obj.el);this.parts.eyeLeft.obj.effect=this.parts.tear.obj}if((B=o.effect)!=null?B.angry:void 0){this.parts.angry={obj:new t(o,"effect")};j=["top","bottom"];for(R=0,v=j.length;R<v;R++){a=j[R];d=document.createElement("div");d.className=""+n+"effect "+n+"angry-"+a;this.parts.angry.obj.el.appendChild(d)}this.outline.appendChild(this.parts.angry.obj.el);this.parts.eyeBrowRight.obj.effect=this.parts.angry.obj}this.el.appendChild(this.outline);this.moving=0}i.prototype.state=function(){return{eyebrow:this.parts.eyeBrowLeft.obj.cur-100,eye:this.parts.eyeLeft.obj.cur-100,mouth:this.parts.mouth.obj.cur-100}};i.prototype.set=function(t,s,e){var i,o,r,h,n,a,u,p,d,l,c,f=this;if(e==null){e={}}if(this.moving>0){d=this.parts;for(h in d){n=d[h];n.obj.abort()}}a={};if(typeof t==="string"){a[t]=s}else{e=s!=null?s:{};a=t}if(e.speed==null){e.speed=10}e.speed=Number(e.speed);if(e.animate==null){e.animate=true}r=[];for(t in a){s=a[t];l=this.parts;for(h in l){n=l[h];if(n.key!=null){if(n.key===t){r.push({parts:h,value:s})}}}}this.moving=r.length;i=function(){if(--f.moving===0){return typeof e.complete==="function"?e.complete():void 0}};c=[];for(u=0,p=r.length;u<p;u++){o=r[u];c.push(this.parts[o.parts].obj.set(o.value,e,i))}return c};return i}();this.FaceEmotion=i}).call(this);